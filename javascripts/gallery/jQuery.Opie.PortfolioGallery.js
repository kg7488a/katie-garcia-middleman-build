function debug(t){arguments.length>1?console.log(arguments):console.log(t)}function __isNumeric(t){return t===L?q:void 0===t?q:""==t?q:(t=t.toString().replace(/,/g,g),isNaN(t)==P?q:P)}function __toNumber(t){return typeof t==D&&(t=this.valueOf()),void 0==t?q:(t=t.toString().replace(/,/g,g),__isNumeric(t)?t.match(/\./)?parseFloat(t):parseInt(t):0)}function __toArray(t){return ___isArray(t)?t:this.valueOf().toString().trim().split(/,/g)}var p="auto",T="[object Object]",X="filters",Y="data-opie-",K=100,g=".",L=null,P=!0,q=!1,D="undefined",m="object",___isArray=function(t){return typeof t===m?typeof t.length==D?q:P:q},__applyToAll=function(t,e){Array.prototype[t]=e,String.prototype[t]=e,Number.prototype[t]=e,Date.prototype[t]=e,Function.prototype[t]=e,RegExp.prototype[t]=e,Boolean.prototype[t]=e},__applyTo=function(t,e,r){if(t.match(/,/i))for(ex=t.split(/,/i),i=0;i<ex.length;i++)__apply(ex[i],e,r);else __apply(t,e,r)},__apply=function(t,e,i){"Array"==t?Array.prototype[e]=i:"String"==t?String.prototype[e]=i:"Number"==t?Number.prototype[e]=i:"Date"==t?Date.prototype[e]=i:"Function"==t?Function.prototype[e]=i:"RegExp"==t?RegExp.prototype[e]=i:"Boolean"==t&&(Boolean.prototype[e]=i)};__apply("Array","isIn",function(t){if(___isArray(t))var e=t;else var e=t.toString().split(/,/g);arr=this.valueOf();for(var i=0;i<arr.length;i++){arrValue=arr[i];for(var r=0;r<e.length;r++)if(exValue=e[r],exValue==arrValue)return!0}return!1}),__applyToAll("toNumber",__toNumber);var __toNegative=function(){var t=__toNumber(this.valueOf());return 0>=t?t:-1*t};__applyToAll("toNegative",__toNegative),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.compare||(Array.prototype.compare=function(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var e=0;e<this.length;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].compare(t[e]))return!1}else if(this[e]!=t[e])return!1;return!0});var __toPositive=function(){var t=__toNumber(this.valueOf());return 0>=t&&(t=-1*t),t};__applyToAll("toPositive",__toPositive),__applyToAll("toArray",__toArray);var __toJSON=function(t){var e=typeof t;if(e!=m||t===L)return"string"==e&&(t='"'+t+'"'),String(t);var i,r,a=[],n=t&&t.constructor==Array;for(i in t)r=t[i],e=typeof r,"string"==e?r='"'+r+'"':e==m&&r!==L&&(r=__toJSON(r)),a.push((n?"":'"'+i+'":')+String(r));return(n?"[":"{")+String(a)+(n?"]":"}")};String.prototype.toJSON=__toJSON;var __toBool=function(){var t=this.valueOf();return"1"===t||1===t||"true"===t||t==P?P:q};__applyToAll("toBool",__toBool);var __mathString=function(t){this.valueOf().toNumber||console.trace();var e=this.valueOf().toNumber();return t=t.replace(" ",""),$op=t.substring(0,1),mathValue=__toNumber(t.substring(1)),newValue=mathValue,"+"==$op?newValue=e+mathValue:"*"==$op?newValue=e*mathValue:"-"==$op?newValue=e-mathValue:"%"==$op?newValue=e*mathValue/K:"/"!=$op&&":"!=$op||(newValue=e/mathValue),newValue};__applyTo("String,Number","math",__mathString),Function.prototype.eBind=function(t,e,i){var r=this;return function(){var a=e||arguments;if(i===P)a=Array.prototype.slice.call(arguments,0),a=a.concat(e);else if("number"==typeof i&&isFinite(i)){a=Array.prototype.slice.call(arguments,0);var n=[i,0].concat(e);Array.prototype.splice.apply(a,n)}return r.apply(t||window,a)}},Function.prototype.delay=function(t,e,i){var r=this,i=i||[],a=r.eBind(e,i);return window.setTimeout(a,t),r},String.prototype.toCamelCase=function(){return this.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}).replace("-","")},Array.prototype.remove=function(t,e){var i=this.slice((e||t)+1||this.length);return this.length=0>t?this.length+t:t,this.push.apply(this,i)},__toFloat=function(){return parseFloat(this.valueOf())},__applyToAll("toFloat",__toFloat),__toInt=function(){return parseInt(this.valueOf())},__applyToAll("toInt",__toInt),$.support.transition=function(){var t=document.body||document.documentElement,e=t.style,i=void 0!==e.transition||void 0!==e.WebkitTransition||void 0!==e.MozTransition||void 0!==e.MsTransition||void 0!==e.OTransition;return i}(),jQuery.fn.setData=function(t,e){if("[object Object]"===String(t)&&"undefined"==typeof e){for(var i in t)jQuery(this).data("opie-"+i,t[i]);return this}return jQuery(this).data("opie-"+t,e)},jQuery.fn.getData=function(t){return jQuery(this).data("opie-"+t)},jQuery.fn.setAttr=function(t,e){return jQuery(this).attr(Y+t,e)},jQuery.fn.getAttr=function(t){return jQuery(this).attr(Y+t)},jQuery.fn.delAttr=function(t){return jQuery(this).removeAttr(Y+t)},jQuery.fn.hasFilter=function(t){if(t===q||typeof t==D)return P;var e=jQuery(this).getData(X);return typeof e[t]!=D?P:q},jQuery.fn.parseFilters=function(t){var e=jQuery(this),i=t?[]:{};if(e.getAttr("filter")){var r=e.getAttr("filter").toString().split(",");r.length>0&&jQuery.each(r,function(e,r){t?i.push(r):i[r]=!0})}return jQuery(this).setData("filters",i),e},jQuery.fn.replaceClass=function(t,e){return typeof e==D&&(t.toString().indexOf("|")>=0?(ex=t.split("|"),t=ex[0],e=ex[1]):e=t),this.removeClass(t).addClass(e)},jQuery.fn.ok=function(){return this.size()>0?P:q},jQuery.fn.getID=function(){return this.attr("id")},jQuery.fn.ID=function(t){return typeof t!=D?this.attr("id",t):this.attr("id")},jQuery.fn.reverse=[].reverse;var Is=new function(){this.object=function(t){return String(t)===T},this.defined=function(t){return typeof t!==D},this.array=function(t){return"object"==typeof t?"undefined"!=typeof t.length:!1},this.number=function(t){return"number"==typeof t&&isFinite(t)},this.string=function(t){return"string"==typeof t},this.func=function(t){return"function"==typeof t},this.cssSelector=function(t){if(Is.string(t)){if("#"==t)return q;if("#"==t.substr(0,1)||t.substr(0,1)==g)return P}return q},this.between=function(t,e,i,r){var a=function(t,e,i){return t>=e&&i>=t?P:q};if($.isArray(t)){var n=q;return"and"==r?$.each(t,function(t,r){return a(r,e,i)?void 0:(n=q,q)}):$.each(t,function(t,r){return a(r,e,i)?(n=P,q):void 0}),n}return a(t,e,i)}},Utils=new function(){this.clone=function(t){if(t==L||!Is.object(t))return t;var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=Utils.clone(t[i]));return e},this.defaultValue=function(t,e){return e=Is.defined(e)?e:q,Is.defined(t)?t:e},this.roundNumber=function(t,e){var i=Math.round(t*Math.pow(10,e))/Math.pow(10,e);return i},this.calcNewImageSize=function(t,e,i,r,a){if(finalHeight=r,finalWidth=i,!Is.defined(a)){var a=q;a=t>e?"W":"H",i==p&&(a="H"),r==p&&(a="W")}return"H"==a?(i=Utils.roundNumber(r*(t/e),0),r=finalHeight):"W"==a&&(r=Utils.roundNumber(i*(e/t),0),i=finalWidth),{ratio:a,h:r,w:i}}},Opts=function(t,e){this.opts=t,this.jq=e};Opts.prototype={get:function(t){return this.parse(this.opts[t])},string:function(t){return this.parse(this.opts[t],P)},number:function(t){return parseFloat(this.get(t))},bool:function(t){var e=this.get(t);return"1"==e||e===P?P:q},selector:function(t){return this.jq(this.get(t))},func:function(t){return this.parse(this.opts[t],P,P)},parse:function(t,e,i){if(typeof t==D)return"";var r=t.valueOf();if("function"==typeof r)return i==P?r:r();if(Is.cssSelector(r)&&e!==P){var a=this.jq(r);if(a.size()<=0)return debug("Opts.parse "+r+" not found"),falese;var n="INPUT"==a.get(0).tagName&&"checkbox"==a.attr("type").toString().toLowerCase();return n?a.is(":checked"):a.val()}return r}},function(t){"use strict";t.fn.OpiePortfolioGallery=function(e,i){var r,a={boxSelector:".o-box",innerWrapperSelector:".o-inner-wrapper",bigImageSelector:"img.o-big-image",thumbImageSelector:"img.o-thumb-image",extraInfoSelector:".o-extra-info",enlargeButtonSelector:".o-enlarge",maxBoxSize:195,loaderFadeInDuration:150,loaderFadeOutDuration:450,boxMovementDuration:300,delayIncrease:0,delayStart:0,maxDelay:0,scrollingAid:!0,boxPositionEasing:"linear",extraInfoOpenEasing:"linear",extraInfoCloseEasing:"linear",boxOpenEasing:"linear",boxCloseEasing:"linear",boxOpenDuration:300,boxCloseDuration:300,filterNavSelector:!1,dontResizeThumbs:!1,useCentering:!1,userCSS3Accelerate:!0,showMore:12},n=new Opts(t.extend(a,e),t);return this.each(function(){r=new t.OpiePortfolioGallery(n,t(this),arguments),"initCSS3"===e?IS.initCSS3.apply(r,i):r.init()}),this},t.OpiePortfolioGallery=function(e,i){var r=this,a=i.find(e.string("boxSelector")),n=i.find(e.string("innerWrapperSelector")),o=e.number("maxBoxSize"),s=0,l=0,u=0,f=!1,c=0,p=e.bool("userCSS3Accelerate"),h=e.number("boxCloseDuration"),d=e.get("boxCloseEasing"),g=e.number("boxMovementDuration"),v=e.get("boxPositionEasing"),m=e.number("delayIncrease"),y=e.get("boxOpenEasing"),b=e.get("boxOpenDuration");this.init=function(){if(this.initCSS3(),e.string("filterNavSelector")!==!1){var n=t(e.string("filterNavSelector")),o=n.filter(".active");o.size()>0&&(f=o.getAttr("filter")),n.click(function(){n.removeClass("active"),a.removeClass("doReduce doEnlarge"),t(this).addClass("active"),f=t(this).getAttr("filter"),r.fillTiles(!1,!0)})}a.each(function(){var i=t(this);if(i.parseFilters(),i.find(e.string("extraInfoSelector")).size()>0){var r=i.find(e.string("bigImageSelector"));r.parent().is("a")&&(r=r.parent()),r.wrap('<div class="o-big-image-wrapper" />'),i.find(".o-big-image-wrapper").append('<a href="#" class="o-enlarge closed"><span>Enlarge</span></a>')}i.setData("positionData",!1),i.append('<div class="loader" />')}),a.find(e.string("enlargeButtonSelector")).click(function(){var a=t(this),n=t(this).parents(e.string("boxSelector"));return i.hasClass("inMotion")?!1:(n.hasClass("doEnlarge")?(n.replaceClass("doEnlarge","doReduce"),a.replaceClass("opened","closed")):(a.replaceClass("closed","opened"),n.replaceClass("doReduce","doEnlarge")),r.fillTiles(!1,!1),!1)}),a.click(function(e){var n=t(e.target);if(i.hasClass("inMotion"))return!1;var o=t(this);if(o.hasClass("portrait")?(window.targetWidth=2,window.targetHeight=3):(window.targetWidth=4,window.targetHeight=2),o.hasClass("o-show-more"))r.showMore();else if(a.removeClass("doReduce doEnlarge"),o.hasClass("active")?o.removeClass("active").addClass("preDeActive"):o.addClass("preactive"),r.loader(a.filter(".active").addClass("wasActive"),!0),r.loader(o,!0),r.fillTiles(!0,!1,!0),!n.parent().is("a"))return!1}),r.initSizes();var s,l,u=function(){var t=0;return function(e,i){clearTimeout(t),t=setTimeout(e,i)}}(),c=t(window).resize(function(){var t=c.width(),i=c.height();s==t&&l==i||u(function(){a.removeClass("active doEnlarge doReduce"),a.find(e.string("bigImageSelector")).css("width","").css("height",""),r.initSizes()},300),s=t,l=i})},this.initCSS3=function(){if(p&&t.support.transition){JsCss.init();var e="all "+g/1e3+"s cubic-bezier("+CSS3Easings[v]+")";JsCss.addRuleStyle(".opie-portfolio .o-box.moving",{"-webkit-transition":e,"-moz-transition":e,"-o-transition":e,"-ms-transition":e,transition:e});var e="all "+b/1e3+"s cubic-bezier("+CSS3Easings[y]+")";JsCss.addRuleStyle(".opie-portfolio .o-box.opening",{"-webkit-transition":e,"-moz-transition":e,"-o-transition":e,"-ms-transition":e,transition:e})}},this.initSizes=function(){a.setData("positionData",!1);var t=i.outerWidth(!0)-(i.outerWidth()-i.width());n.width(t);var l=t/o,u=Utils.roundNumber(l,2).toString().replace(/,/g,".").split("."),f=e.bool("dontResizeThumbs");if(f===!1)if(Is.defined(u[1])&&u[1]<50)var p=Math.ceil(l);else var p=Math.floor(l);else var p=u[0].toNumber();var h=!0;if(s=Math.floor(100/p/100*t),f===!1)for(;h;)s>o?(p++,s=100/p/100*t):h=!1;if(s>o){s=o;var d=o*p;t>d&&e.bool("useCentering")===!0&&(c=t-d,n.width(t-c))}r.fillTiles(!1,!0)},this.loadThumbs=function(i){Is.defined(i)||(i=a.not(".o-hidden")),i.each(function(){var i=t(this),a=t(this).find(e.string("thumbImageSelector")),n=a.getAttr("src"),o=!1;n&&("auto"==n&&(o=!0,n=i.find(e.string("bigImageSelector")).getAttr("src"),a.addClass("auto")),a.unbind("load").load(function(){a.delAttr("src"),o&&(this.naturalWidth>this.naturalHeight&&o?(a.addClass("height"),a.css("marginLeft",this.width/2*-1)):(a.addClass("width"),a.css("marginTop",this.height/2*-1))),a.addClass("loaded"),r.loader(i,!1)}).attr("src",n)),isTouchDevice()||i.hover(function(){t(this).replaceClass("mouseOut","mouseOn")},function(){t(this).replaceClass("mouseOn","mouseOut")})})},this.loader=function(i,r){1==r?i.find("div.loader").each(function(){t(this).stop().fadeIn(e.number("loaderFadeInDuration"))}):i.find("div.loader").each(function(){t(this).stop().stop().fadeOut(e.number("loaderFadeOutDuration"))})},this.rePosImg=function(e,i,r,a){var n={};if(r>e){var o=Utils.calcNewImageSize(r,a,e-2*(i-a),"auto");r=o.w,a=o.h,n.width=r,n.height=a}n.marginLeft=(e-r)/2,n.marginTop=(i-a)/2,t(this).css(n)},this.fillTiles=function(o,u){if(i.hasClass("inMotion"))return!1;i.addClass("inMotion"),l=0;var c=0,C=0,_=n.innerWidth(),S=0,w=0,A=0,x=0,D=a.filter(".preactive,.doEnlarge,.doReduce").size(),I=e.number("maxDelay");0==I&&(I=999999999);var O=e.number("delayStart"),N=function(e){var i=!0;e.addClass("moving");for(var a=0;a<e.length;a++){var n=t(e[a]);if(n.hasFilter(f)?n.removeClass("filtered"):n.addClass("filterOut"),!n.hasClass("preactive")&&!n.hasClass("doEnlarge")&&!n.hasClass("doReduce")||n.hasClass("filterOut")){var o={width:s,height:s},y={};if(n.hasClass("filterOut")||n.hasClass("filtered")||n.hasClass("o-hidden"))n.hasClass("filtered")||(1==i?(o.left=s.toNegative(),i=!1):(o.left=_+s,i=!0),o.top=s.toNegative(),n.addClass("filtered"));else{o.left=C,o.top=c;var b=C+s;if(b>_&&(c+=s,C=0),b=C+s,H=c+s,D>0)for(var N=!0;N;)if(Is.between(C,S,w-1)&&Is.between(c,A,x-1)||Is.between(b-1,S,w-1)&&Is.between(H-1,A,x-1)){C=w;var b=C+s;b>_?(c+=s,C=0,N=!0):N=!1}else N=!1;var b=C+s;b>_&&(c+=s,C=0),o.left=C,o.top=c,C+=s,l=Math.max(l,c+s)}n.hasClass("preDeActive")||n.hasClass("active")?(y.duration=h,y.easing=d):(y.duration=g,y.easing=v),y.complete=function(){var e=t(this);(e.hasClass("active")||e.hasClass("o-show-more")||e.hasClass("preDeActive"))&&r.loader(e,!1),e.removeClass("preDeActive active moving"),e.hasClass("last")&&r.afterLastAnimation()};var T=n.getData("LastAnimCss");if(1==u&&n.setData("positionData",{left:o.left,top:o.top}),n.hasClass("o-hidden"))n.css(o),y.complete.eBind(n)();else{var P=!0;T&&T.left==o.left&&T.top==o.top&&T.height==o.height&&T.width==o.width&&(P=!1),1==P?(p&&t.support.transition?(n.css.eBind(n,[o]).delay(O),y.complete.eBind(n).delay(O+y.duration)):(y.queue=!1,n.delay(O).animate(o,y)),I>O&&(O+=m)):y.complete.eBind(n)()}n.setData("LastAnimCss",o)}else n.removeClass("activated moving")}};a.removeClass("filterOut");var T=o?a.not(".filtered,.filterOut"):a;a.removeClass("last"),T.last().addClass("last");var P=T.filter(".doEnlarge");if(P.size()>0){var j={},z={duration:e.number("extraInfoOpenDuration")};P.setData("beforeEnlargeHeight",P.height());var E=P.outerWidth(!0),q=P.outerHeight(!0)+P.find(e.string("extraInfoSelector")).outerHeight(!0),F=Math.ceil(q/s);q+=F*s-q,j.height=q;var M=P.position();j.left=M.left,j.top=M.top,S=j.left,w=S+E,A=j.top,x=A+q,l=Math.max(l,x),z.easing=e.get("extraInfoCloseEasing"),P.delay(O).animate(j,z),I>O&&(O+=e.number("delayIncrease")),P.hasFilter(f)||P.addClass("filterOut"),P.setData("LastAnimCss",j),P=!1}var Q=T.filter(".doReduce");if(Q.size()>0){var j={},z={duration:e.number("extraInfoCloseDuration")},E=Q.outerWidth(!0),q=Q.getData("beforeEnlargeHeight");j.height=q;var M=Q.position();j.left=M.left,j.top=M.top,S=j.left,w=S+E,A=j.top,x=A+q,l=Math.max(l,x),z.easing=e.get("extraInfoOpenEasing"),Q.animate(j,z),Q.hasFilter(f)||Q.addClass("filterOut"),Q.setData("LastAnimCss",j),Q=!1}var B=T.filter(".preactive");if(B.size()>0){B.addClass("opening");var j={},z={duration:b},E=s*targetWidth,q=s*targetHeight;E>_&&(E=_),j.width=E,j.height=q;var V=B.getData("positionData");if(V!==!1&&B.hasClass("last")&&B.prevAll(e.string("boxSelector")+".wasActive").size()>0||B.nextAll(e.string("boxSelector")+".wasActive").size()>0)j.left=V.left,j.top=V.top;else{var M=B.position();j.left=M.left,j.top=M.top}a.removeClass("wasActive");var W=j.left+E,H=j.top+q;if(W>_){var L=_-E;j.left=L,j.left<0&&(j.left=0)}if(S=j.left,w=S+E,A=j.top,x=A+q,l=Math.max(l,x),e.bool("scrollingAid")){var R=t(window).scrollTop(),$=n.offset(),k=t(window).height()+R,U=$.top+x;U>k&&t("html, body").animate({scrollTop:"+="+(U-k+q/2)},300);var J=$.top+A;R>J&&t("html, body").animate({scrollTop:J-q/2},300)}z.complete=function(){var i=t(this),a=i.find(e.string("bigImageSelector"));if(a.getAttr("src")){var n=a.getAttr("src");a.unbind("load").load(function(){a.setData("width",this.naturalWidth),a.setData("height",this.naturalHeight),r.rePosImg.call(a,E,q,this.naturalWidth,this.naturalHeight),i.replaceClass("preactive","active"),a.delAttr("src"),r.loader(i,!1)}).attr("src",n)}else r.rePosImg.call(a,E,q,a.getData("width"),a.getData("height")),i.replaceClass("preactive","active"),r.loader(i,!1);i.removeClass("opening").find(e.string("enlargeButtonSelector")).removeClass("opened"),i.hasClass("last")&&r.afterLastAnimation()},z.easing=y,p&&t.support.transition?(B.css.eBind(B,[j]).delay(O),z.complete.eBind(B).delay(O+z.duration)):(z.queue=!1,B.delay(O).animate(j,z)),B.hasFilter(f)||B.addClass("filterOut"),I>O&&(O+=e.number("delayIncrease")),N(B.prevAll().reverse()),O=0,N(B.nextAll(),!0),B.setData("LastAnimCss",j),B=!1}else N(T);r.fixPortSize(!1)},this.showMore=function(){var t=e.number("showMore");t||(t=1);a.filter(".o-hidden").slice(0,t).removeClass("o-hidden");r.fillTiles(!1,!0)},this.afterLastAnimation=function(){i.removeClass("inMotion"),window.setTimeout(r.loadThumbs,100),r.fixPortSize(!0),a.filter(".o-hidden").size()<=0&&a.filter(".o-show-more").hide()},this.fixPortSize=function(t){var e=n.position().top+n.innerHeight();if(l>e)var i="+="+(l-e);else var i="-="+(e-l);return 0==t&&u>l?!1:(n.stop().animate({height:i},"fast"),void(u=l))}}}(jQuery);