function debug(t){arguments.length>1?console.log(arguments):console.log(t)}function __isNumeric(t){return t===L?q:void 0===t?q:""==t?q:(t=t.toString().replace(/,/g,g),isNaN(t)==P?q:P)}function __toNumber(t){return typeof t==D&&(t=this.valueOf()),void 0==t?q:(t=t.toString().replace(/,/g,g),__isNumeric(t)?t.match(/\./)?parseFloat(t):parseInt(t):0)}function __toArray(t){return ___isArray(t)?t:this.valueOf().toString().trim().split(/,/g)}var p="auto",T="[object Object]",X="filters",Y="data-opie-",K=100,g=".",L=null,P=!0,q=!1,D="undefined",m="object",___isArray=function(t){return typeof t===m?typeof t.length==D?q:P:q},__applyToAll=function(t,e){Array.prototype[t]=e,String.prototype[t]=e,Number.prototype[t]=e,Date.prototype[t]=e,Function.prototype[t]=e,RegExp.prototype[t]=e,Boolean.prototype[t]=e},__applyTo=function(t,e,r){if(t.match(/,/i))for(ex=t.split(/,/i),i=0;i<ex.length;i++)__apply(ex[i],e,r);else __apply(t,e,r)},__apply=function(t,e,r){"Array"==t?Array.prototype[e]=r:"String"==t?String.prototype[e]=r:"Number"==t?Number.prototype[e]=r:"Date"==t?Date.prototype[e]=r:"Function"==t?Function.prototype[e]=r:"RegExp"==t?RegExp.prototype[e]=r:"Boolean"==t&&(Boolean.prototype[e]=r)};__apply("Array","isIn",function(t){if(___isArray(t))var e=t;else var e=t.toString().split(/,/g);arr=this.valueOf();for(var r=0;r<arr.length;r++){arrValue=arr[r];for(var i=0;i<e.length;i++)if(exValue=e[i],exValue==arrValue)return!0}return!1}),__applyToAll("toNumber",__toNumber);var __toNegative=function(){var t=__toNumber(this.valueOf());return 0>=t?t:-1*t};__applyToAll("toNegative",__toNegative),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.compare||(Array.prototype.compare=function(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var e=0;e<this.length;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].compare(t[e]))return!1}else if(this[e]!=t[e])return!1;return!0});var __toPositive=function(){var t=__toNumber(this.valueOf());return 0>=t&&(t=-1*t),t};__applyToAll("toPositive",__toPositive),__applyToAll("toArray",__toArray);var __toJSON=function(t){var e=typeof t;if(e!=m||t===L)return"string"==e&&(t='"'+t+'"'),String(t);var r,i,a=[],n=t&&t.constructor==Array;for(r in t)i=t[r],e=typeof i,"string"==e?i='"'+i+'"':e==m&&i!==L&&(i=__toJSON(i)),a.push((n?"":'"'+r+'":')+String(i));return(n?"[":"{")+String(a)+(n?"]":"}")};String.prototype.toJSON=__toJSON;var __toBool=function(){var t=this.valueOf();return"1"===t||1===t||"true"===t||t==P?P:q};__applyToAll("toBool",__toBool);var __mathString=function(t){this.valueOf().toNumber||console.trace();var e=this.valueOf().toNumber();return t=t.replace(" ",""),$op=t.substring(0,1),mathValue=__toNumber(t.substring(1)),newValue=mathValue,"+"==$op?newValue=e+mathValue:"*"==$op?newValue=e*mathValue:"-"==$op?newValue=e-mathValue:"%"==$op?newValue=e*mathValue/K:"/"!=$op&&":"!=$op||(newValue=e/mathValue),newValue};__applyTo("String,Number","math",__mathString),Function.prototype.eBind=function(t,e,r){var i=this;return function(){var a=e||arguments;if(r===P)a=Array.prototype.slice.call(arguments,0),a=a.concat(e);else if("number"==typeof r&&isFinite(r)){a=Array.prototype.slice.call(arguments,0);var n=[r,0].concat(e);Array.prototype.splice.apply(a,n)}return i.apply(t||window,a)}},Function.prototype.delay=function(t,e,r){var i=this,r=r||[],a=i.eBind(e,r);return window.setTimeout(a,t),i},String.prototype.toCamelCase=function(){return this.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}).replace("-","")},Array.prototype.remove=function(t,e){var r=this.slice((e||t)+1||this.length);return this.length=0>t?this.length+t:t,this.push.apply(this,r)},__toFloat=function(){return parseFloat(this.valueOf())},__applyToAll("toFloat",__toFloat),__toInt=function(){return parseInt(this.valueOf())},__applyToAll("toInt",__toInt),$.support.transition=function(){var t=document.body||document.documentElement,e=t.style,r=void 0!==e.transition||void 0!==e.WebkitTransition||void 0!==e.MozTransition||void 0!==e.MsTransition||void 0!==e.OTransition;return r}(),jQuery.fn.setData=function(t,e){if("[object Object]"===String(t)&&"undefined"==typeof e){for(var r in t)jQuery(this).data("opie-"+r,t[r]);return this}return jQuery(this).data("opie-"+t,e)},jQuery.fn.getData=function(t){return jQuery(this).data("opie-"+t)},jQuery.fn.setAttr=function(t,e){return jQuery(this).attr(Y+t,e)},jQuery.fn.getAttr=function(t){return jQuery(this).attr(Y+t)},jQuery.fn.delAttr=function(t){return jQuery(this).removeAttr(Y+t)},jQuery.fn.hasFilter=function(t){if(t===q||typeof t==D)return P;var e=jQuery(this).getData(X);return typeof e[t]!=D?P:q},jQuery.fn.parseFilters=function(t){var e=jQuery(this),r=t?[]:{};if(e.getAttr("filter")){var i=e.getAttr("filter").toString().split(",");i.length>0&&jQuery.each(i,function(e,i){t?r.push(i):r[i]=!0})}return jQuery(this).setData("filters",r),e},jQuery.fn.replaceClass=function(t,e){return typeof e==D&&(t.toString().indexOf("|")>=0?(ex=t.split("|"),t=ex[0],e=ex[1]):e=t),this.removeClass(t).addClass(e)},jQuery.fn.ok=function(){return this.size()>0?P:q},jQuery.fn.getID=function(){return this.attr("id")},jQuery.fn.ID=function(t){return typeof t!=D?this.attr("id",t):this.attr("id")},jQuery.fn.reverse=[].reverse;var Is=new function(){this.object=function(t){return String(t)===T},this.defined=function(t){return typeof t!==D},this.array=function(t){return"object"==typeof t?"undefined"!=typeof t.length:!1},this.number=function(t){return"number"==typeof t&&isFinite(t)},this.string=function(t){return"string"==typeof t},this.func=function(t){return"function"==typeof t},this.cssSelector=function(t){if(Is.string(t)){if("#"==t)return q;if("#"==t.substr(0,1)||t.substr(0,1)==g)return P}return q},this.between=function(t,e,r,i){var a=function(t,e,r){return t>=e&&r>=t?P:q};if($.isArray(t)){var n=q;return"and"==i?$.each(t,function(t,i){return a(i,e,r)?void 0:(n=q,q)}):$.each(t,function(t,i){return a(i,e,r)?(n=P,q):void 0}),n}return a(t,e,r)}},Utils=new function(){this.clone=function(t){if(t==L||!Is.object(t))return t;var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=Utils.clone(t[r]));return e},this.defaultValue=function(t,e){return e=Is.defined(e)?e:q,Is.defined(t)?t:e},this.roundNumber=function(t,e){var r=Math.round(t*Math.pow(10,e))/Math.pow(10,e);return r},this.calcNewImageSize=function(t,e,r,i,a){if(finalHeight=i,finalWidth=r,!Is.defined(a)){var a=q;a=t>e?"W":"H",r==p&&(a="H"),i==p&&(a="W")}return"H"==a?(r=Utils.roundNumber(i*(t/e),0),i=finalHeight):"W"==a&&(i=Utils.roundNumber(r*(e/t),0),r=finalWidth),{ratio:a,h:i,w:r}}},Opts=function(t,e){this.opts=t,this.jq=e};Opts.prototype={get:function(t){return this.parse(this.opts[t])},string:function(t){return this.parse(this.opts[t],P)},number:function(t){return parseFloat(this.get(t))},bool:function(t){var e=this.get(t);return"1"==e||e===P?P:q},selector:function(t){return this.jq(this.get(t))},func:function(t){return this.parse(this.opts[t],P,P)},parse:function(t,e,r){if(typeof t==D)return"";var i=t.valueOf();if("function"==typeof i)return r==P?i:i();if(Is.cssSelector(i)&&e!==P){var a=this.jq(i);if(a.size()<=0)return debug("Opts.parse "+i+" not found"),falese;var n="INPUT"==a.get(0).tagName&&"checkbox"==a.attr("type").toString().toLowerCase();return n?a.is(":checked"):a.val()}return i}},function(t){"use strict";t.fn.OpiePortfolioGallery=function(e,r){var i,a="linear",n={boxSelector:".o-box",innerWrapperSelector:".o-inner-wrapper",bigImageSelector:"img.o-big-image",thumbImageSelector:"img.o-thumb-image",extraInfoSelector:".o-extra-info",enlargeButtonSelector:".o-enlarge",maxBoxSize:195,loaderFadeInDuration:150,loaderFadeOutDuration:450,boxMovementDuration:300,delayIncrease:0,delayStart:0,maxDelay:0,scrollingAid:P,boxPositionEasing:a,extraInfoOpenEasing:a,extraInfoCloseEasing:a,boxOpenEasing:a,boxCloseEasing:a,boxOpenDuration:300,boxCloseDuration:300,filterNavSelector:q,dontResizeThumbs:q,useCentering:q,userCSS3Accelerate:P,showMore:12},o=new Opts(t.extend(n,e),t);return this.each(function(){i=new t.OpiePortfolioGallery(o,t(this),arguments),"initCSS3"===e?IS.initCSS3.apply(i,r):i.init()}),this},t.OpiePortfolioGallery=function(e,r){var i="inMotion",a="o-hidden",n="bigImageSelector",o="src",s=".o-hidden",l="delayIncrease",u="boxSelector",f=this,c=r.find(e.string(u)),h=r.find(e.string("innerWrapperSelector")),d=e.number("maxBoxSize"),g=0,v=0,m=0,y=q,b=0,C=e.bool("userCSS3Accelerate"),_=e.number("boxCloseDuration"),S=e.get("boxCloseEasing"),w=e.number("boxMovementDuration"),A=e.get("boxPositionEasing"),x=e.number(l),D=e.get("boxOpenEasing"),I=e.get("boxOpenDuration");this.init=function(){if(this.initCSS3(),e.string("filterNavSelector")!==!1){var i=t(e.string("filterNavSelector")),a=i.filter(".active");a.size()>0&&(y=a.getAttr("filter")),i.click(function(){i.removeClass("active"),c.removeClass("doReduce doEnlarge"),t(this).addClass("active"),y=t(this).getAttr("filter"),f.fillTiles(!1,!0)})}c.each(function(){var r=t(this);if(r.parseFilters(),r.find(e.string("extraInfoSelector")).size()>0){var i=r.find(e.string("bigImageSelector"));i.parent().is("a")&&(i=i.parent()),i.wrap('<div class="o-big-image-wrapper" />'),r.find(".o-big-image-wrapper").append('<a href="#" class="o-enlarge closed"><span>Enlarge</span></a>')}r.setData("positionData",!1),r.append('<div class="loader" />')}),c.find(e.string("enlargeButtonSelector")).click(function(){var i=t(this),a=t(this).parents(e.string("boxSelector"));return r.hasClass("inMotion")?!1:(a.hasClass("doEnlarge")?(a.replaceClass("doEnlarge","doReduce"),i.replaceClass("opened","closed")):(i.replaceClass("closed","opened"),a.replaceClass("doReduce","doEnlarge")),f.fillTiles(!1,!1),!1)}),c.click(function(e){var i=t(e.target);if(r.hasClass("inMotion"))return!1;var a=t(this);if(a.hasClass("o-show-more"))f.showMore();else if(c.removeClass("doReduce doEnlarge"),a.hasClass("active")?a.removeClass("active").addClass("preDeActive"):a.addClass("preactive"),f.loader(c.filter(".active").addClass("wasActive"),!0),f.loader(a,!0),f.fillTiles(!0,!1,!0),!i.parent().is("a"))return!1}),f.initSizes();var n,o,s=function(){var t=0;return function(e,r){clearTimeout(t),t=setTimeout(e,r)}}(),l=t(window).resize(function(){var t=l.width(),r=l.height();n==t&&o==r||s(function(){c.removeClass("active doEnlarge doReduce"),c.find(e.string("bigImageSelector")).css("width","").css("height",""),f.initSizes()},300),n=t,o=r})},this.initCSS3=function(){var e="s cubic-bezier(";if(C&&t.support.transition){JsCss.init();var r="all "+w/1e3+e+CSS3Easings[A]+")";JsCss.addRuleStyle(".opie-portfolio .o-box.moving",{"-webkit-transition":r,"-moz-transition":r,"-o-transition":r,"-ms-transition":r,transition:r});var r="all "+I/1e3+e+CSS3Easings[D]+")";JsCss.addRuleStyle(".opie-portfolio .o-box.opening",{"-webkit-transition":r,"-moz-transition":r,"-o-transition":r,"-ms-transition":r,transition:r})}},this.initSizes=function(){c.setData("positionData",!1);var t=r.outerWidth(!0)-(r.outerWidth()-r.width());h.width(t);var i=t/d,a=Utils.roundNumber(i,2).toString().replace(/,/g,".").split("."),n=e.bool("dontResizeThumbs");if(n===!1)if(Is.defined(a[1])&&a[1]<50)var o=Math.ceil(i);else var o=Math.floor(i);else var o=a[0].toNumber();var s=!0;if(g=Math.floor(100/o/100*t),n===!1)for(;s;)g>d?(o++,g=100/o/100*t):s=!1;if(g>d){g=d;var l=d*o;t>l&&e.bool("useCentering")===!0&&(b=t-l,h.width(t-b))}f.fillTiles(!1,!0)},this.loadThumbs=function(r){Is.defined(r)||(r=c.not(s)),r.each(function(){var r="mouseOn",i="mouseOut",a=t(this),s=t(this).find(e.string("thumbImageSelector")),l=s.getAttr(o),u=q;l&&(l==p&&(u=P,l=a.find(e.string(n)).getAttr(o),s.addClass(p)),s.unbind("load").load(function(){s.delAttr("src"),u&&(this.naturalWidth>this.naturalHeight&&u?(s.addClass("height"),s.css("marginLeft",this.width/2*-1)):(s.addClass("width"),s.css("marginTop",this.height/2*-1))),s.addClass("loaded"),f.loader(a,!1)}).attr("src",l)),a.hover(function(){t(this).replaceClass(i,r)},function(){t(this).replaceClass(r,i)})})},this.loader=function(r,i){var a="div.loader";i==P?r.find(a).each(function(){t(this).stop().fadeIn(e.number("loaderFadeInDuration"))}):r.find(a).each(function(){t(this).stop().stop().fadeOut(e.number("loaderFadeOutDuration"))})},this.rePosImg=function(e,r,i,a){var n={};if(i>e){var o=Utils.calcNewImageSize(i,a,e-2*(r-a),p);i=o.w,a=o.h,n.width=i,n.height=a}n.marginLeft=(e-i)/2,n.marginTop=(r-a)/2,t(this).css(n)},this.fillTiles=function(i,a){if(r.hasClass("inMotion"))return!1;r.addClass("inMotion"),v=0;var n=0,o=0,s=h.innerWidth(),l=0,u=0,p=0,d=0,m=c.filter(".preactive,.doEnlarge,.doReduce").size(),b=e.number("maxDelay");0==b&&(b=999999999);var O=e.number("delayStart"),P=function(e){var r=!0;e.addClass("moving");for(var i=0;i<e.length;i++){var c=t(e[i]);if(c.hasFilter(y)?c.removeClass("filtered"):c.addClass("filterOut"),!c.hasClass("preactive")&&!c.hasClass("doEnlarge")&&!c.hasClass("doReduce")||c.hasClass("filterOut")){var h={width:g,height:g},D={};if(c.hasClass("filterOut")||c.hasClass("filtered")||c.hasClass("o-hidden"))c.hasClass("filtered")||(1==r?(h.left=g.toNegative(),r=!1):(h.left=s+g,r=!0),h.top=g.toNegative(),c.addClass("filtered"));else{h.left=o,h.top=n;var I=o+g;if(I>s&&(n+=g,o=0),I=o+g,W=n+g,m>0)for(var P=!0;P;)if(Is.between(o,l,u-1)&&Is.between(n,p,d-1)||Is.between(I-1,l,u-1)&&Is.between(W-1,p,d-1)){o=u;var I=o+g;I>s?(n+=g,o=0,P=!0):P=!1}else P=!1;var I=o+g;I>s&&(n+=g,o=0),h.left=o,h.top=n,o+=g,v=Math.max(v,n+g)}c.hasClass("preDeActive")||c.hasClass("active")?(D.duration=_,D.easing=S):(D.duration=w,D.easing=A),D.complete=function(){var e=t(this);(e.hasClass("active")||e.hasClass("o-show-more")||e.hasClass("preDeActive"))&&f.loader(e,!1),e.removeClass("preDeActive active moving"),e.hasClass("last")&&f.afterLastAnimation()};var N=c.getData("LastAnimCss");if(1==a&&c.setData("positionData",{left:h.left,top:h.top}),c.hasClass("o-hidden"))c.css(h),D.complete.eBind(c)();else{var T=!0;N&&N.left==h.left&&N.top==h.top&&N.height==h.height&&N.width==h.width&&(T=!1),1==T?(C&&t.support.transition?(c.css.eBind(c,[h]).delay(O),D.complete.eBind(c).delay(O+D.duration)):(D.queue=!1,c.delay(O).animate(h,D)),b>O&&(O+=x)):D.complete.eBind(c)()}c.setData("LastAnimCss",h)}else c.removeClass("activated moving")}};c.removeClass("filterOut");var N=i?c.not(".filtered,.filterOut"):c;c.removeClass("last"),N.last().addClass("last");var T=N.filter(".doEnlarge");if(T.size()>0){var q={},j={duration:e.number("extraInfoOpenDuration")};T.setData("beforeEnlargeHeight",T.height());var z=T.outerWidth(!0),E=T.outerHeight(!0)+T.find(e.string("extraInfoSelector")).outerHeight(!0),F=Math.ceil(E/g);E+=F*g-E,q.height=E;var M=T.position();q.left=M.left,q.top=M.top,l=q.left,u=l+z,p=q.top,d=p+E,v=Math.max(v,d),j.easing=e.get("extraInfoCloseEasing"),T.delay(O).animate(q,j),b>O&&(O+=e.number("delayIncrease")),T.hasFilter(y)||T.addClass("filterOut"),T.setData("LastAnimCss",q),T=!1}var Q=N.filter(".doReduce");if(Q.size()>0){var q={},j={duration:e.number("extraInfoCloseDuration")},z=Q.outerWidth(!0),E=Q.getData("beforeEnlargeHeight");q.height=E;var M=Q.position();q.left=M.left,q.top=M.top,l=q.left,u=l+z,p=q.top,d=p+E,v=Math.max(v,d),j.easing=e.get("extraInfoOpenEasing"),Q.animate(q,j),Q.hasFilter(y)||Q.addClass("filterOut"),Q.setData("LastAnimCss",q),Q=!1}var B=N.filter(".preactive");if(B.size()>0){B.addClass("opening");var q={},j={duration:I},z=4*g,E=2*g;z>s&&(z=s),q.width=z,q.height=E;var V=B.getData("positionData");if(V!==!1&&B.hasClass("last")&&B.prevAll(e.string("boxSelector")+".wasActive").size()>0||B.nextAll(e.string("boxSelector")+".wasActive").size()>0)q.left=V.left,q.top=V.top;else{var M=B.position();q.left=M.left,q.top=M.top}c.removeClass("wasActive");var L=q.left+z,W=q.top+E;if(L>s){var R=s-z;q.left=R,q.left<0&&(q.left=0)}if(l=q.left,u=l+z,p=q.top,d=p+E,v=Math.max(v,d),e.bool("scrollingAid")){var H=t(window).scrollTop(),$=h.offset(),k=t(window).height()+H,U=$.top+d;U>k&&t("html, body").animate({scrollTop:"+="+(U-k+E/2)},300);var J=$.top+p;H>J&&t("html, body").animate({scrollTop:J-E/2},300)}j.complete=function(){var r=t(this),i=r.find(e.string("bigImageSelector"));if(i.getAttr("src")){var a=i.getAttr("src");i.unbind("load").load(function(){i.setData("width",this.naturalWidth),i.setData("height",this.naturalHeight),f.rePosImg.call(i,z,E,this.naturalWidth,this.naturalHeight),r.replaceClass("preactive","active"),i.delAttr("src"),f.loader(r,!1)}).attr("src",a)}else f.rePosImg.call(i,z,E,i.getData("width"),i.getData("height")),r.replaceClass("preactive","active"),f.loader(r,!1);r.removeClass("opening").find(e.string("enlargeButtonSelector")).removeClass("opened"),r.hasClass("last")&&f.afterLastAnimation()},j.easing=D,C&&t.support.transition?(B.css.eBind(B,[q]).delay(O),j.complete.eBind(B).delay(O+j.duration)):(j.queue=!1,B.delay(O).animate(q,j)),B.hasFilter(y)||B.addClass("filterOut"),b>O&&(O+=e.number("delayIncrease")),P(B.prevAll().reverse()),O=0,P(B.nextAll(),!0),B.setData("LastAnimCss",q),B=!1}else P(N);f.fixPortSize(!1)},this.showMore=function(){var t=e.number("showMore");t||(t=1);c.filter(s).slice(0,t).removeClass(a);f.fillTiles(q,P)},this.afterLastAnimation=function(){r.removeClass(i),window.setTimeout(f.loadThumbs,K),f.fixPortSize(P),c.filter(s).size()<=0&&c.filter(".o-show-more").hide()},this.fixPortSize=function(t){var e=h.position().top+h.innerHeight();if(v>e)var r="+="+(v-e);else var r="-="+(e-v);return t==q&&m>v?q:(h.stop().animate({height:r},"fast"),void(m=v))}}}(jQuery);